pico-8 cartridge // http://www.pico-8.com
version 39
__lua__
-- converts a number to a hex
-- string.
-- source: https://www.lexaloffle.com/bbs/?tid=30910
-- by: felice
function num2hex(v) 
    local s,l,r=tostr(v,true),3,11
    while sub(s,l,l)=="0" do l+=1 end
    while sub(s,r,r)=="0" do r-=1 end
    return sub(s,min(l,6),flr(v)==v and 6 or max(r,8))
end
 
cls()

print("processing sprite sheet...\n\n")

local cur_color=sget(0,0)
local cur_count=0
local result=""

for y=0,32 do
    for x=0,127 do
        local next_color=sget(x,y)
        if next_color==cur_color 
            and cur_count<15 then
            -- same color
            cur_count+=1
        else
            --write to buffer
            result=result..num2hex(cur_count)
            --todo: hex
            result=result..num2hex(cur_color)
            --reset
            cur_color=next_color
            cur_count=1
        end
    end
end

printh("\""..result.."\"", '@clip')

print("done!\n\nresult copied to clipboard.\npaste into game cart.")
__gfx__
44444424444442444444244444424444442444444244444424444442444444244444477774444244444424444442444444244474425544442444444244444424
22222224444442222222244444424444442444444244544424444442444444244444742447444244444424544442444444244474425744442444444244444424
44444424445442444444244444424444442444444244444424444442444444244447442444744244444424444442444444244474425744442444444244444424
44544424444442445444244444424444442444444244444424444442444444244474442444474244444422222222444444244474425744442444444244444424
44444422222222444444244444424444442444444222222224444442444444244555555555555244444424444442444444244447425744442444444244444424
44444424444442444444244444424444442444444244444424444442444444244511111111115245444424444542444444222227225744442444444244444424
44444424444542444444244444424454442444444244444424444442454454244511919991115244445424444442444444244447425744442444544244444424
44444424444442444444244444424444442444444244454424444442444444244511999999115244444424444442444444245447425744442444444244444424
44444424444442444444244444422222222444444244444424444442222222244511919991115222222224444442444444244447425744442222222244444424
44444424444442444444244444424444442444444244444424444442444444244511111111115244444424444442444444244446425754442444444244444424
44444424444442444444244444424444442444444244444424444442444544244555555555555244454424444442444444244646425544442445444244444424
4444442444fff2ff4f44fff4fff24444442445444244444424444442444444244444442444444244444424444442444444244464425744442444444244444424
444444244fffffffffffffffffff4444542444444244444424444542444444244444442444444244444424444442445444244444425744442444444244444424
44444424ffff00f0f0ff0ff00ff24444442222222244444424444442444444244444442444444244444424444442444444244444425744442444444244445424
4444442444f0fff0f0f0f0f0f0ff4444442444444244444424444442444444244454442444444244444424444442222222244444425744442444444244444424
444444244fff0ff000f0f0f00ff24444442444444244444422222222444444244444442444444244444424644442444444244444425744442444444222222224
44444424ff00fff0f0ff0ff0ffff4444442444454244444424444442444444242222222444444244444426664442444454244444425744442444444244444424
444444244ffffffffffffffffff24444442444444244444424544542444444244444442444444244444424600442444444244444425744442444444244544424
454444244ffffffffffffffff4f24444442444444244444424444442444444244444442444444244444424440048484444244444425754442444444244444424
4444442444f442f4f4442ff4f4424444442444444244444424444400444444244444542444444244444424444008484444244444425544442444444244444424
22222224444442444444222222224444442444444744444424111002445444244444442444454244444424444600644444244444425744442444444244444424
44444424444442444444244444424444442444447274446661110011454544244444442444444244444424446560654444244444425744442444444244444424
44444424444442444444244445424444442444447255446666111111555555554444442222222244444424446555554444244444425722222444444244444424
4444442444444244444424444442444444244447425744442ddddddddddddd244444442444444244444424444555554444244444425744442444444244444424
4444542444444244454424444442444444244447425744442444444244444424ddddddddddddddddddddddddd55555ddddddd8dddddddddddd00000ddddddddd
4444442444444245444424444442444444244447425744442444444244444424ddddddddd77777ddddddddddd55555ddddddd7ddddddddddd0000000dddd8ddd
4444442444444244444424444442444444244447425744442444444244444424dddddddd7ddddd7dddddddddd55555ddddddddddddd77777dd00000dddd888dd
4444442444444222222224444442444444244447425744442444444244444424ddddd667ddddddd7ddd8dddddd555ddddddddddd777ddddd7777777dddd888dd
4444442444444244444424444442444444244474425744542444444245444424dddd6ddddddddd7ddd888ddddddddddddd6dddd7ddddddddd0777770ddd777dd
4444442454454244444424444442444444244474425744442444444244444424ddddd6dddd87dd7ddd777dddddddddddd6ddd77ddddddddddd00000dddd777dd
4444442444444244444424444442444444244474425722222444444222222224ddddddddddddddd7ddd7dddddddddddddd667ddddddddddddddddddddddd7ddd
4444442222222244444424444442444444244474425744442444444244444424dddddddddddddddd7ddddddddddddddddddddddddddddddddddddddddddddddd